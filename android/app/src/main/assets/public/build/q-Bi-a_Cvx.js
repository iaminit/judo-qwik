import{_ as d}from"./q-DoNi8vyY.js";import{R as _}from"./q-BL5itR1-.js";import{B as v,l as g,p as j,q as m,C as t,i as n,G as w,k as x,j as s,u as b,_hW as f}from"./q-GWx3MS6J.js";import{u as h}from"./q-DZEaxapN.js";import{p}from"./q-CpnnSTOF.js";const q=l=>{v();const i=h(),o=g(!1),u=g(null),r=g([]);return j(m(()=>d(()=>Promise.resolve().then(()=>E),void 0),"s_0Nv0qXvzukA",[r,l])),t("form",null,{class:"bg-white dark:bg-gray-900 rounded-3xl p-8 border border-gray-100 dark:border-gray-800 shadow-sm space-y-6",onSubmit$:m(()=>d(()=>Promise.resolve().then(()=>T),void 0),"s_lV54nQEpoY4",[u,o,i,l])},[u.value&&t("div",null,{class:"p-4 bg-red-50 text-red-600 rounded-xl border border-red-100 font-bold"},n(e=>e.value,[u]),3,"j2_0"),t("div",null,{class:"grid grid-cols-1 gap-6"},[(l.type==="info"||l.type==="regulations"||l.type==="timeline")&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Titolo",3,null),t("input",null,{type:"text",name:"titolo",value:n(e=>{var a;return((a=e.item)==null?void 0:a.titolo)||""},[l]),required:!0,class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,"j2_1"),(l.type==="info"||l.type==="programmi")&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Sezione / Sotto-sezione",3,null),t("input",null,{type:"text",name:"categoria_secondaria",value:n(e=>{var a;return((a=e.item)==null?void 0:a.categoria_secondaria)||""},[l]),placeholder:n(e=>e.type==="info"?"es: info, campioni, cinture...":"es: Te Waza, Kata, Teoria...",[l]),class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,"j2_2"),l.type==="timeline"&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Anno",3,null),t("input",null,{type:"number",name:"anno",value:n(e=>{var a;return((a=e.item)==null?void 0:a.anno)||""},[l]),required:!0,class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,"j2_3"),l.type==="regulations"&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Sottotitolo",3,null),t("input",null,{type:"text",name:"titolo_secondario",value:n(e=>{var a;return((a=e.item)==null?void 0:a.titolo_secondario)||""},[l]),class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,"j2_4"),l.type==="regulations"&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Link Esterno",3,null),t("input",null,{type:"url",name:"link_esterno",value:n(e=>{var a;return((a=e.item)==null?void 0:a.link_esterno)||""},[l]),class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,"j2_5"),l.type==="programmi"&&t("div",null,{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Grado Richiesto",3,null),t("select",null,{name:"livello",class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white appearance-none"},r.value.map(e=>{var a;return t("option",{value:w(e,"grado"),selected:Number((a=l.item)==null?void 0:a.livello)===e.grado},null,e.nome_completo,1,e.id)}),1,null)],1,null),t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Ordine",3,null),t("input",null,{type:"number",name:"ordine",value:n(e=>{var a;return((a=e.item)==null?void 0:a.ordine)||0},[l]),class:"w-full px-5 py-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border-none font-bold text-gray-900 dark:text-white"},null,3,null)],3,null)],1,"j2_6"),(l.type==="info"||l.type==="regulations"||l.type==="programmi")&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Contenuto (HTML)",3,null),x(_,{name:"contenuto",id:"contenuto_fijlkam",get value(){var e;return((e=l.item)==null?void 0:e.contenuto)||""},[s]:{name:s,id:s,value:n(e=>{var a;return((a=e.item)==null?void 0:a.contenuto)||""},[l])}},3,"j2_7")],1,"j2_8"),l.type==="timeline"&&t("div",null,{class:"space-y-2"},[t("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Descrizione",3,null),x(_,{name:"contenuto",id:"contenuto_timeline_fijlkam",get value(){var e;return((e=l.item)==null?void 0:e.contenuto)||""},[s]:{name:s,id:s,value:n(e=>{var a;return((a=e.item)==null?void 0:a.contenuto)||""},[l])}},3,"j2_9")],1,"j2_10")],1,null),t("div",null,{class:"pt-6 flex gap-4"},[t("button",null,{type:"submit",disabled:n(e=>e.value,[o]),class:"px-10 py-4 bg-blue-600 text-white font-black rounded-2xl shadow-xl shadow-blue-500/20 hover:scale-105 transition-all disabled:opacity-50"},n(e=>e.value?"Salvataggio...":"Salva Elemento",[o]),3,null),t("button",null,{type:"button",class:"px-10 py-4 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 font-black rounded-2xl hover:bg-gray-200 transition-all",onClick$:m(()=>d(()=>Promise.resolve().then(()=>A),void 0),"s_00HLEW6Rf7U",[i])},"Annulla",3,null)],3,null)],1,"j2_11")},S=async()=>{const[l,i]=b();if(i.type==="programmi")try{const o=await p.collection("livelli_dan").getFullList({sort:"ordine"});l.value=o}catch(o){console.error("[FijlkamForm] Error fetching dan levels:",o)}},E=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_0Nv0qXvzukA:S},Symbol.toStringTag,{value:"Module"})),L=async l=>{const[i,o,u,r]=b();l.preventDefault(),o.value=!0,i.value=null;const y=l.target,e=new FormData(y),a=c=>(c||"untitled").toLowerCase().replace(/[àáâãäå]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,100),k=e.get("titolo");e.get("slug")||e.append("slug",a(k)),r.type==="info"?e.append("tags","info"):r.type==="timeline"?e.append("tags","timeline"):r.type==="regulations"?e.append("tags","regolamento"):r.type==="programmi"&&e.append("tags","esame_dan");try{r.isNew?await p.collection("fijlkam").create(e):await p.collection("fijlkam").update(r.item.id,e),u("/gestione/fijlkam")}catch(c){i.value=c.message||"Errore durante il salvataggio"}finally{o.value=!1}},T=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_lV54nQEpoY4:L},Symbol.toStringTag,{value:"Module"})),z=()=>{const[l]=b();return l("/gestione/fijlkam")},A=Object.freeze(Object.defineProperty({__proto__:null,s_00HLEW6Rf7U:z},Symbol.toStringTag,{value:"Module"}));export{f as _hW,z as s_00HLEW6Rf7U,S as s_0Nv0qXvzukA,q as s_L6fY4FZjTgU,L as s_lV54nQEpoY4};
