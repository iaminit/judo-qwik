import{u as c,l as g,p as w,q as i,J as k,C as t,i as x,G as v,_hW as f}from"./q-GWx3MS6J.js";import{p as m}from"./q-CpnnSTOF.js";import{_ as s}from"./q-DoNi8vyY.js";const T=(e,o)=>{const[l]=c();return l.value=o.type=="number"?o.valueAsNumber:o.value},P=Object.freeze(Object.defineProperty({__proto__:null,s_Ps0jowjxfAM:T},Symbol.toStringTag,{value:"Module"})),O=()=>{const[e]=c();return e.value="IMMAGINI"},j=Object.freeze(Object.defineProperty({__proto__:null,s_ue0aGY9iTgs:O},Symbol.toStringTag,{value:"Module"})),I=()=>{const[e,o]=c();return e(o.url)},S=Object.freeze(Object.defineProperty({__proto__:null,s_TVYIKlvVKiA:I},Symbol.toStringTag,{value:"Module"})),C=()=>{const[e]=c();return e.value="VIDEO"},E=Object.freeze(Object.defineProperty({__proto__:null,s_N1ZKCfKYMEA:C},Symbol.toStringTag,{value:"Module"})),M=()=>{var o;const[e]=c();return(o=e.value)==null?void 0:o.click()},L=Object.freeze(Object.defineProperty({__proto__:null,s_qcU0FdprKk0:M},Symbol.toStringTag,{value:"Module"})),A=()=>{const[e,o]=c();return e(o)},U=Object.freeze(Object.defineProperty({__proto__:null,s_2IyPv8fvU00:A},Symbol.toStringTag,{value:"Module"})),D=async()=>{const[e,o,l]=c();o.value=!0;try{const a=[],u=await fetch("/api/local-media"),d=u.ok?await u.json():[];console.log("[Media Center] Local media received:",d.length,"items"),a.push(...d.map(n=>({id:n.path,collectionName:n.tag,file:n.path,url:n.url,thumb:n.url,name:n.name,type:n.tag.toLowerCase(),source:"local"})));try{const n=await m.collection("gallery").getFullList({sort:"-created",filter:'image != ""',requestKey:null});a.push(...n.map(_=>({id:_.id,collectionId:_.collectionId,collectionName:"GALLERY",file:_.image,url:m.files.getUrl(_,_.image),thumb:m.files.getUrl(_,_.image,{thumb:"200x200"}),name:_.title||_.image,type:"immagini",source:"pocketbase"})))}catch(n){console.warn("[Media Center] Gallery records (pb) not available:",n)}const p=e.value,b=p==="TUTTI"?a:a.filter(n=>n.type.toUpperCase()===p);l.value=b}catch(a){console.error("[Media Center] Error:",a)}finally{o.value=!1}},R=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_p7vPbBqPE2o:D},Symbol.toStringTag,{value:"Module"})),V=()=>{const[e]=c();return e.value="TUTTI"},K=Object.freeze(Object.defineProperty({__proto__:null,s_LHeUb58sLpM:V},Symbol.toStringTag,{value:"Module"})),z=async e=>{try{await navigator.clipboard.writeText(e),alert("URL copiato negli appunti!")}catch(o){console.error("Failed to copy: ",o)}},$=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_HXfvky0U7KE:z},Symbol.toStringTag,{value:"Module"})),G=()=>{const[e,o]=c();if(!o.value)return e.value;const l=o.value.toLowerCase();return e.value.filter(a=>a.name.toLowerCase().includes(l)||a.file.toLowerCase().includes(l))},Y=Object.freeze(Object.defineProperty({__proto__:null,s_9G3hgfl30a0:G},Symbol.toStringTag,{value:"Module"})),N=()=>{const[e]=c();return e.value="POST"},F=Object.freeze(Object.defineProperty({__proto__:null,s_k2eoAnF3wLk:N},Symbol.toStringTag,{value:"Module"})),q=async e=>{const[o,l,a]=c(),u=e.target;if(!(!u.files||u.files.length===0)){a.value=!0;try{const d=new FormData;d.append("file",u.files[0]),l.value!=="TUTTI"&&d.append("folder",l.value.toLowerCase()),(await fetch("/api/upload",{method:"POST",body:d})).ok?await o():alert("Caricamento fallito")}catch(d){console.error("[Media Center] Upload error:",d)}finally{a.value=!1}}},B=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_DRl3MZK0HsU:q},Symbol.toStringTag,{value:"Module"})),H=()=>{const[e]=c();return e.value="AUDIO"},Z=Object.freeze(Object.defineProperty({__proto__:null,s_dnLtjhzGB9U:H},Symbol.toStringTag,{value:"Module"})),X=()=>{const e=g([]),o=g(!0),l=g("TUTTI"),a=g(""),u=g(!1),d=g(),p=i(()=>s(()=>Promise.resolve().then(()=>R),void 0),"s_p7vPbBqPE2o",[l,o,e]);w(i(()=>s(()=>Promise.resolve().then(()=>J),void 0),"s_YK73i9i1aOc",[p,l]));const b=k(i(()=>s(()=>Promise.resolve().then(()=>Y),void 0),"s_9G3hgfl30a0",[e,a])),n=i(()=>s(()=>Promise.resolve().then(()=>$),void 0),"s_HXfvky0U7KE"),_=i(()=>s(()=>Promise.resolve().then(()=>B),void 0),"s_DRl3MZK0HsU",[p,l,u]),h=i(()=>s(()=>Promise.resolve().then(()=>ee),void 0),"s_G8DglRSYdO4",[e]);return t("div",null,{class:"space-y-10 animate-in fade-in duration-700"},[t("header",null,{class:"flex flex-col md:flex-row md:items-center justify-between gap-6"},[t("div",null,null,[t("h2",null,{class:"text-3xl font-black text-gray-900 dark:text-white tracking-tight"},"Media Center",3,null),t("p",null,{class:"text-gray-500 dark:text-gray-400 font-medium mt-1"},"Sincronizzato con PocketBase e cartella locale /media.",3,null)],3,null),t("div",null,{class:"flex flex-col md:flex-row gap-4 items-center"},[t("input",{ref:d},{type:"file",class:"hidden",accept:"image/*,video/*,audio/*",onChange$:_},null,3,null),t("button",null,{disabled:x(r=>r.value,[u]),class:"px-6 py-2 bg-red-600 text-white font-black rounded-xl shadow-lg shadow-red-500/20 hover:scale-105 transition-all text-sm disabled:opacity-50",onClick$:i(()=>s(()=>Promise.resolve().then(()=>L),void 0),"s_qcU0FdprKk0",[d])},x(r=>r.value?"Caricamento...":"âž• Aggiungi File",[u]),3,null),t("div",null,{class:"relative w-full md:w-64"},[t("input",null,{type:"text",placeholder:"Cerca file...",value:a,class:"w-full pl-10 pr-4 py-2 rounded-xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 focus:ring-2 focus:ring-red-500 outline-none transition-all dark:text-white font-bold text-sm",onInput$:i(()=>s(()=>Promise.resolve().then(()=>P),void 0),"s_Ps0jowjxfAM",[a])},null,3,null),t("span",null,{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},"ðŸ”",3,null)],3,null),t("div",null,{class:"flex bg-white dark:bg-gray-900 p-1 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm overflow-x-auto"},[t("button",{class:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${l.value==="TUTTI"?"bg-red-600 text-white shadow-lg shadow-red-500/30":"text-gray-400 hover:text-gray-600"}`},{onClick$:i(()=>s(()=>Promise.resolve().then(()=>K),void 0),"s_LHeUb58sLpM",[l])},"Tutti",3,null),t("button",{class:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${l.value==="IMMAGINI"?"bg-red-600 text-white shadow-lg shadow-red-500/30":"text-gray-400 hover:text-gray-600"}`},{onClick$:i(()=>s(()=>Promise.resolve().then(()=>j),void 0),"s_ue0aGY9iTgs",[l])},"Immagini",3,null),t("button",{class:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${l.value==="VIDEO"?"bg-red-600 text-white shadow-lg shadow-red-500/30":"text-gray-400 hover:text-gray-600"}`},{onClick$:i(()=>s(()=>Promise.resolve().then(()=>E),void 0),"s_N1ZKCfKYMEA",[l])},"Video",3,null),t("button",{class:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${l.value==="AUDIO"?"bg-red-600 text-white shadow-lg shadow-red-500/30":"text-gray-400 hover:text-gray-600"}`},{onClick$:i(()=>s(()=>Promise.resolve().then(()=>Z),void 0),"s_dnLtjhzGB9U",[l])},"Audio",3,null),t("button",{class:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${l.value==="POST"?"bg-red-600 text-white shadow-lg shadow-red-500/30":"text-gray-400 hover:text-gray-600"}`},{onClick$:i(()=>s(()=>Promise.resolve().then(()=>F),void 0),"s_k2eoAnF3wLk",[l])},"Post",3,null)],1,null)],1,null)],1,null),t("div",null,{class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"},o.value?Array.from({length:12}).map((r,y)=>t("div",null,{class:"aspect-square bg-white dark:bg-gray-900 rounded-3xl animate-pulse border border-gray-100 dark:border-gray-800"},null,3,y)):b.value.map(r=>t("div",null,{class:"group relative aspect-square bg-white dark:bg-gray-900 rounded-3xl border border-gray-100 dark:border-gray-800 overflow-hidden shadow-sm hover:shadow-xl transition-all hover:scale-[1.02]"},[r.type==="video"?t("div",null,{class:"w-full h-full flex items-center justify-center bg-gray-50 dark:bg-gray-800 p-2 rounded-3xl"},t("span",null,{class:"text-4xl"},"ðŸŽ¥",3,null),3,"r4_0"):r.type==="audio"?t("div",null,{class:"w-full h-full flex items-center justify-center bg-gray-50 dark:bg-gray-800 p-2 rounded-3xl"},t("span",null,{class:"text-4xl text-red-500"},"ðŸ”Š",3,null),3,"r4_1"):t("img",{src:v(r,"thumb"),alt:v(r,"name")},{class:"w-full h-full object-cover p-2 rounded-3xl"},null,3,null),t("div",null,{class:"absolute inset-0 bg-black/60 opacity-20 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center p-4 text-center"},[t("p",null,{class:"text-[10px] font-black text-white uppercase tracking-tight line-clamp-2 mb-2"},v(r,"name"),1,null),t("div",null,{class:"flex gap-2"},[t("button",{onClick$:i(()=>s(()=>Promise.resolve().then(()=>S),void 0),"s_TVYIKlvVKiA",[n,r])},{class:"p-2 bg-white/20 hover:bg-white/40 text-white rounded-lg transition-colors",title:"Copia URL"},"ðŸ”—",2,null),t("a",{href:v(r,"url")},{target:"_blank",class:"p-2 bg-white/20 hover:bg-white/40 text-white rounded-lg transition-colors",title:"Apri Originale"},"ðŸ‘ï¸",3,null),t("button",{onClick$:i(()=>s(()=>Promise.resolve().then(()=>U),void 0),"s_2IyPv8fvU00",[h,r])},{class:"p-2 bg-red-500/80 hover:bg-red-500 text-white rounded-lg transition-colors",title:"Elimina"},"ðŸ—‘ï¸",2,null)],1,null),t("div",null,{class:"absolute bottom-2 left-0 right-0 flex flex-col gap-1"},[t("span",null,{class:"text-[8px] font-black text-gray-400 uppercase tracking-widest"},v(r,"collectionName"),1,null),t("span",{class:`text-[7px] font-black uppercase tracking-tighter ${r.source==="local"?"text-blue-400":"text-emerald-400"}`},null,r.source==="local"?"ðŸ“ Cartella Locale":"â˜ï¸ PocketBase",1,null)],1,null)],1,null)],1,`${r.source}-${r.id}`)),1,null),!o.value&&b.value.length===0&&t("div",null,{class:"py-20 text-center"},[t("div",null,{class:"text-6xl mb-4"},"ðŸ“‚",3,null),t("p",null,{class:"text-gray-500 font-bold uppercase tracking-widest"},"Nessun file trovato.",3,null)],3,"r4_2")],1,"r4_3")},re=Object.freeze(Object.defineProperty({__proto__:null,s_udMC0wX10tU:X},Symbol.toStringTag,{value:"Module"})),Q=async({track:e})=>{const[o,l]=c();e(()=>l.value),o()},J=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_YK73i9i1aOc:Q},Symbol.toStringTag,{value:"Module"})),W=async e=>{const[o]=c();if(confirm(`Sei sicuro di voler eliminare "${e.name}"?`))try{if(e.source==="pocketbase"&&e.collectionName)await m.collection(e.collectionName).delete(e.id);else if(e.source==="local"&&!(await fetch("/api/delete-media",{method:"POST",body:JSON.stringify({fileName:e.file}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Delete failed");o.value=o.value.filter(l=>l.id!==e.id)}catch(l){console.error("[Media Center] Delete error:",l),alert("Errore durante l'eliminazione")}},ee=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_G8DglRSYdO4:W},Symbol.toStringTag,{value:"Module"}));export{f as _hW,re as i,A as s_2IyPv8fvU00,G as s_9G3hgfl30a0,q as s_DRl3MZK0HsU,W as s_G8DglRSYdO4,z as s_HXfvky0U7KE,V as s_LHeUb58sLpM,C as s_N1ZKCfKYMEA,T as s_Ps0jowjxfAM,I as s_TVYIKlvVKiA,Q as s_YK73i9i1aOc,H as s_dnLtjhzGB9U,N as s_k2eoAnF3wLk,D as s_p7vPbBqPE2o,M as s_qcU0FdprKk0,X as s_udMC0wX10tU,O as s_ue0aGY9iTgs};
