import{u as y,b as X,q as m,B as ee,l as E,p as te,C as d,k as se,G as ne,i as M,j as ie,_hW as T}from"./q-GWx3MS6J.js";import{_ as f}from"./q-DoNi8vyY.js";class g extends Error{constructor(e){var t,s,n,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,g.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof g||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(e.name=="AbortError"||e.code==20)&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(n=(s=this.originalError)==null?void 0:s.cause)==null?void 0:n.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const A=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function re(r,e){const t={};if(typeof r!="string")return t;const s=Object.assign({},{}).decode||oe;let n=0;for(;n<r.length;){const i=r.indexOf("=",n);if(i===-1)break;let o=r.indexOf(";",n);if(o===-1)o=r.length;else if(o<i){n=r.lastIndexOf(";",i-1)+1;continue}const a=r.slice(n,i).trim();if(t[a]===void 0){let c=r.slice(i+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{t[a]=s(c)}catch{t[a]=c}}n=o+1}return t}function B(r,e,t){const s=Object.assign({},t||{}),n=s.encode||ae;if(!A.test(r))throw new TypeError("argument name is invalid");const i=n(e);if(i&&!A.test(i))throw new TypeError("argument val is invalid");let o=r+"="+i;if(s.maxAge!=null){const a=s.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(s.domain){if(!A.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!A.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(s.expires)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.priority)switch(typeof s.priority=="string"?s.priority.toLowerCase():s.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function oe(r){return r.indexOf("%")!==-1?decodeURIComponent(r):r}function ae(r){return encodeURIComponent(r)}const ce=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let W;function R(r){if(r)try{const e=decodeURIComponent(W(r.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function G(r,e=0){let t=R(r);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}W=typeof atob!="function"||ce?r=>{let e=String(r).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,s,n=0,i=0,o="";s=e.charAt(i++);~s&&(t=n%4?64*t+s:s,n++%4)?o+=String.fromCharCode(255&t>>(-2*n&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return o}:atob;const K="pb_auth";class N{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!G(this.token)}get isSuperuser(){var t,s;let e=R(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((s=this.record)!=null&&s.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),R(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=K){const s=re(e||"")[t]||"";let n={};try{n=JSON.parse(s),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch{}this.save(n.token||"",n.record||n.model||null)}exportToCookie(e,t=K){var c,u;const s={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},n=R(this.token);s.expires=n!=null&&n.exp?new Date(1e3*n.exp):new Date("1970-01-01"),e=Object.assign({},s,e);const i={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=B(t,JSON.stringify(i),e);const a=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.record&&a>4096){i.record={id:(c=i.record)==null?void 0:c.id,email:(u=i.record)==null?void 0:u.email};const w=["collectionId","collectionName","verified"];for(const p in this.record)w.includes(p)&&(i.record[p]=this.record[p]);o=B(t,JSON.stringify(i),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let s=this._onChangeCallbacks.length-1;s>=0;s--)if(this._onChangeCallbacks[s]==e)return delete this._onChangeCallbacks[s],void this._onChangeCallbacks.splice(s,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class le extends N{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let s=t;typeof t!="string"&&(s=JSON.stringify(t)),window.localStorage.setItem(e,s)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class S{constructor(e){this.client=e}}class ue extends S{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,s,n){return n=Object.assign({method:"POST",body:{email:t,template:s,collection:e}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,s,n,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:s,privateKey:n,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const de=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function D(r){if(r){r.query=r.query||{};for(let e in r)de.includes(e)||(r.query[e]=r[e],delete r[e])}}function H(r){const e=[];for(const t in r){const s=encodeURIComponent(t),n=Array.isArray(r[t])?r[t]:[r[t]];for(let i of n)i=he(i),i!==null&&e.push(s+"="+i)}return e.join("&")}function he(r){return r==null?null:r instanceof Date?encodeURIComponent(r.toISOString().replace("T"," ")):encodeURIComponent(typeof r=="object"?JSON.stringify(r):r)}class J extends S{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,s){var o;if(!e)throw new Error("topic must be set.");let n=e;if(s){D(s=Object.assign({},s));const a="options="+encodeURIComponent(JSON.stringify({query:s.query,headers:s.headers}));n+=(n.includes("?")?"&":"?")+a}const i=function(a){const c=a;let u;try{u=JSON.parse(c==null?void 0:c.data)}catch{}t(u||{})};return this.subscriptions[n]||(this.subscriptions[n]=[]),this.subscriptions[n].push(i),this.isConnected?this.subscriptions[n].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(n,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var s;let t=!1;if(e){const n=this.getSubscriptionsByTopic(e);for(let i in n)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(s=this.eventSource)==null||s.removeEventListener(i,o);delete this.subscriptions[i],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var s;let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let i of this.subscriptions[n])(s=this.eventSource)==null||s.removeEventListener(n,i);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var i;let s=!1;const n=this.getSubscriptionsByTopic(e);for(let o in n){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let a=!1;for(let c=this.subscriptions[o].length-1;c>=0;c--)this.subscriptions[o][c]===t&&(a=!0,delete this.subscriptions[o][c],this.subscriptions[o].splice(c,1),(i=this.eventSource)==null||i.removeEventListener(o,t));a&&(this.subscriptions[o].length||delete this.subscriptions[o],s||this.hasSubscriptionListeners(o)||(s=!0))}this.hasSubscriptionListeners()?s&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,s;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let n in this.subscriptions)if((s=this.subscriptions[n])!=null&&s.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let s in this.subscriptions)(s+"?").startsWith(e)&&(t[s]=this.subscriptions[s]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let s=3;for(;this.hasUnsentSubscriptions()&&s>0;)s--,await this.submitSubscriptions()}).then(()=>{for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const s=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in s)for(let i of s[n])i(e)}).catch(s=>{this.clientId="",this.connectErrorHandler(s)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let s of this.pendingConnects)s.reject(new g(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[]}}}class Y extends S{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let s=500;return(t=Object.assign({},e,t)).batch&&(s=t.batch,delete t.batch),this._getFullList(s,t)}async getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send(this.baseCrudPath,s).then(n=>{var i;return n.items=((i=n.items)==null?void 0:i.map(o=>this.decode(o)))||[],n})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(s=>{var n;if(!((n=s==null?void 0:s.items)!=null&&n.length))throw new g({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return s.items[0]})}async getOne(e,t){if(!e)throw new g({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(s=>this.decode(s))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(s=>this.decode(s))}async update(e,t,s){return s=Object.assign({method:"PATCH",body:t},s),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),s).then(n=>this.decode(n))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let s=[],n=async i=>this.getList(i,e||500,t).then(o=>{const a=o.items;return s=s.concat(a),a.length==o.perPage?n(i+1):s});return n(1)}}function O(r,e,t,s){const n=s!==void 0;return n||t!==void 0?n?(console.warn(r),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,s),e):Object.assign(e,t):e}function j(r){var e;(e=r._resetAutoRefresh)==null||e.call(r)}class pe extends Y{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,s){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,s)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const s=Object.assign({},e,t);return super.getFullList(s)}async getList(e=1,t=30,s){return super.getList(e,t,s)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,s){return super.update(e,t,s).then(n=>{var i,o,a;if(((i=this.client.authStore.record)==null?void 0:i.id)===(n==null?void 0:n.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((a=this.client.authStore.record)==null?void 0:a.collectionName)===this.collectionIdOrName)){let c=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,n);c&&(u.expand=Object.assign(c,n.expand)),this.client.authStore.save(this.client.authStore.token,u)}return n})}async delete(e,t){return super.delete(e,t).then(s=>{var n,i,o;return!s||((n=this.client.authStore.record)==null?void 0:n.id)!==e||((i=this.client.authStore.record)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),s})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,s){let n;s=Object.assign({method:"POST",body:{identity:e,password:t}},s),this.isSuperusers&&(n=s.autoRefreshThreshold,delete s.autoRefreshThreshold,s.autoRefresh||j(this.client));let i=await this.client.send(this.baseCollectionPath+"/auth-with-password",s);return i=this.authResponse(i),n&&this.isSuperusers&&function(a,c,u,w){j(a);const p=a.beforeSend,l=a.authStore.record,v=a.authStore.onChange((_,h)=>{(!_||(h==null?void 0:h.id)!=(l==null?void 0:l.id)||(h!=null&&h.collectionId||l!=null&&l.collectionId)&&(h==null?void 0:h.collectionId)!=(l==null?void 0:l.collectionId))&&j(a)});a._resetAutoRefresh=function(){v(),a.beforeSend=p,delete a._resetAutoRefresh},a.beforeSend=async(_,h)=>{var b;const x=a.authStore.token;if((b=h.query)!=null&&b.autoRefresh)return p?p(_,h):{url:_,sendOptions:h};let I=a.authStore.isValid;if(I&&G(a.authStore.token,c))try{await u()}catch{I=!1}I||await w();const L=h.headers||{};for(let P in L)if(P.toLowerCase()=="authorization"&&x==L[P]&&a.authStore.token){L[P]=a.authStore.token;break}return h.headers=L,p?p(_,h):{url:_,sendOptions:h}}}(this.client,n,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},s))),i}async authWithOAuth2Code(e,t,s,n,i,o,a){let c={method:"POST",body:{provider:e,code:t,codeVerifier:s,redirectURL:n,createData:i}};return c=O("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",c,o,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let s=null;t.urlCallback||(s=z(void 0));const n=new J(this.client);function i(){s==null||s.close(),n.unsubscribe()}const o={},a=t.requestKey;return a&&(o.requestKey=a),this.listAuthMethods(o).then(c=>{var l;const u=c.oauth2.providers.find(v=>v.name===t.provider);if(!u)throw new g(new Error(`Missing or invalid provider "${t.provider}".`));const w=this.client.buildURL("/api/oauth2-redirect"),p=a?(l=this.client.cancelControllers)==null?void 0:l[a]:void 0;return p&&(p.signal.onabort=()=>{i()}),new Promise(async(v,_)=>{var h;try{await n.subscribe("@oauth2",async b=>{var F;const P=n.clientId;try{if(!b.state||P!==b.state)throw new Error("State parameters don't match.");if(b.error||!b.code)throw new Error("OAuth2 redirect error or missing code: "+b.error);const C=Object.assign({},t);delete C.provider,delete C.scopes,delete C.createData,delete C.urlCallback,(F=p==null?void 0:p.signal)!=null&&F.onabort&&(p.signal.onabort=null);const Z=await this.authWithOAuth2Code(u.name,b.code,u.codeVerifier,w,t.createData,C);v(Z)}catch(C){_(new g(C))}i()});const x={state:n.clientId};(h=t.scopes)!=null&&h.length&&(x.scope=t.scopes.join(" "));const I=this._replaceQueryParams(u.authURL+w,x);await(t.urlCallback||function(b){s?s.location.href=b:s=z(b)})(I)}catch(x){i(),_(new g(x))}})}).catch(c=>{throw i(),c})}async authRefresh(e,t){let s={method:"POST"};return s=O("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",s,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",s).then(n=>this.authResponse(n))}async requestPasswordReset(e,t,s){let n={method:"POST",body:{email:e}};return n=O("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(e,t,s,n,i){let o={method:"POST",body:{token:e,password:t,passwordConfirm:s}};return o=O("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,t,s){let n={method:"POST",body:{email:e}};return n=O("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}async confirmVerification(e,t,s){let n={method:"POST",body:{token:e}};return n=O("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>{const i=R(e),o=this.client.authStore.record;return o&&!o.verified&&o.id===i.id&&o.collectionId===i.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,t,s){let n={method:"POST",body:{newEmail:e}};return n=O("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,t,s),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}async confirmEmailChange(e,t,s,n){let i={method:"POST",body:{token:e,password:t}};return i=O("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,s,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const o=R(e),a=this.client.authStore.record;return a&&a.id===o.id&&a.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,s){const n=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(n.id,s).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,s){return s=Object.assign({method:"POST",body:{otpId:e,password:t}},s),this.client.send(this.baseCollectionPath+"/auth-with-otp",s).then(n=>this.authResponse(n))}async impersonate(e,t,s){(s=Object.assign({method:"POST",body:{duration:t}},s)).headers=s.headers||{},s.headers.Authorization||(s.headers.Authorization=this.client.authStore.token);const n=new Q(this.client.baseURL,new N,this.client.lang),i=await n.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),s);return n.authStore.save(i==null?void 0:i.token,this.decode((i==null?void 0:i.record)||{})),n}_replaceQueryParams(e,t={}){let s=e,n="";e.indexOf("?")>=0&&(s=e.substring(0,e.indexOf("?")),n=e.substring(e.indexOf("?")+1));const i={},o=n.split("&");for(const a of o){if(a=="")continue;const c=a.split("=");i[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let a in t)t.hasOwnProperty(a)&&(t[a]==null?delete i[a]:i[a]=t[a]);n="";for(let a in i)i.hasOwnProperty(a)&&(n!=""&&(n+="&"),n+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(i[a].replace(/%20/g,"+")));return n!=""?s+"?"+n:s}}function z(r){if(typeof window>"u"||!(window!=null&&window.open))throw new g(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,s=window.innerWidth,n=window.innerHeight;e=e>s?s:e,t=t>n?n:t;let i=s/2-e/2,o=n/2-t/2;return window.open(r,"popup_window","width="+e+",height="+t+",top="+o+",left="+i+",resizable,menubar=no")}class ge extends Y{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,s){return s=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},s),this.client.send(this.baseCrudPath+"/import",s).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class be extends S{async getList(e=1,t=30,s){return(s=Object.assign({method:"GET"},s)).query=Object.assign({page:e,perPage:t},s.query),this.client.send("/api/logs",s)}async getOne(e,t){if(!e)throw new g({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class me extends S{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class fe extends S{getUrl(e,t,s={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,s)}getURL(e,t,s={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(e.collectionId||e.collectionName)),n.push(encodeURIComponent(e.id)),n.push(encodeURIComponent(t));let i=this.client.buildURL(n.join("/"));if(Object.keys(s).length){s.download===!1&&delete s.download;const o=new URLSearchParams(s);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class ye extends S{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class _e extends S{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/crons/${encodeURIComponent(e)}`,t).then(()=>!0)}}function q(r){return typeof Blob<"u"&&r instanceof Blob||typeof File<"u"&&r instanceof File||r!==null&&typeof r=="object"&&r.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function U(r){var e;return r&&(((e=r.constructor)==null?void 0:e.name)==="FormData"||typeof FormData<"u"&&r instanceof FormData)}function $(r){for(const e in r){const t=Array.isArray(r[e])?r[e]:[r[e]];for(const s of t)if(q(s))return!0}return!1}const Se=/^[\-\.\d]+$/;function V(r){if(typeof r!="string")return r;if(r=="true")return!0;if(r=="false")return!1;if((r[0]==="-"||r[0]>="0"&&r[0]<="9")&&Se.test(r)){let e=+r;if(""+e===r)return e}return r}class we extends S{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new ve(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,s=[];for(let n=0;n<this.requests.length;n++){const i=this.requests[n];if(s.push({method:i.method,url:i.url,headers:i.headers,body:i.json}),i.files)for(let o in i.files){const a=i.files[o]||[];for(let c of a)t.append("requests."+n+"."+o,c)}}return t.append("@jsonPayload",JSON.stringify({requests:s})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class ve{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const s={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(s,t),this.requests.push(s)}create(e,t){t=Object.assign({body:e||{}},t);const s={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(s,t),this.requests.push(s)}update(e,t,s){s=Object.assign({body:t||{}},s);const n={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(n,s),this.requests.push(n)}delete(e,t){t=Object.assign({},t);const s={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,t),this.requests.push(s)}prepareRequest(e,t){if(D(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const n=H(t.query);n&&(e.url+=(e.url.includes("?")?"&":"?")+n)}let s=t.body;U(s)&&(s=function(i){let o={};return i.forEach((a,c)=>{if(c==="@jsonPayload"&&typeof a=="string")try{let u=JSON.parse(a);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[c]!==void 0?(Array.isArray(o[c])||(o[c]=[o[c]]),o[c].push(V(a))):o[c]=V(a)}),o}(s));for(const n in s){const i=s[n];if(q(i))e.files[n]=e.files[n]||[],e.files[n].push(i);else if(Array.isArray(i)){const o=[],a=[];for(const c of i)q(c)?o.push(c):a.push(c);if(o.length>0&&o.length==i.length){e.files[n]=e.files[n]||[];for(let c of o)e.files[n].push(c)}else if(e.json[n]=a,o.length>0){let c=n;n.startsWith("+")||n.endsWith("+")||(c+="+"),e.files[c]=e.files[c]||[];for(let u of o)e.files[c].push(u)}}else e.json[n]=i}}}class Q{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,s="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=s,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new N:this.authStore=new le,this.collections=new ge(this),this.files=new fe(this),this.logs=new be(this),this.settings=new ue(this),this.realtime=new J(this),this.health=new me(this),this.backups=new ye(this),this.crons=new _e(this)}get admins(){return this.collection("_superusers")}createBatch(){return new we(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new pe(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let s in t){let n=t[s];switch(typeof n){case"boolean":case"number":n=""+n;break;case"string":n="'"+n.replace(/'/g,"\\'")+"'";break;default:n=n===null?"null":n instanceof Date?"'"+n.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(n).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+s+"}",n)}return e}getFileUrl(e,t,s={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,s)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var s;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(s=window.location.origin)!=null&&s.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let s=this.buildURL(e);if(this.beforeSend){const n=Object.assign({},await this.beforeSend(s,t));n.url!==void 0||n.options!==void 0?(s=n.url||s,t=n.options||t):Object.keys(n).length&&(t=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const n=H(t.query);n&&(s+=(s.includes("?")?"&":"?")+n),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(s,t).then(async n=>{var o;let i={};try{i=await n.json()}catch(a){if((o=t.signal)!=null&&o.aborted||typeof DOMException<"u"&&a instanceof DOMException&&(a.name=="AbortError"||a.code==20))throw a}if(this.afterSend&&(i=await this.afterSend(n,i,t)),n.status>=400)throw new g({url:n.url,status:n.status,data:i});return i}).catch(n=>{throw new g(n)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(n){if(typeof FormData>"u"||n===void 0||typeof n!="object"||n===null||U(n)||!$(n))return n;const i=new FormData;for(const o in n){const a=n[o];if(a!==void 0)if(typeof a!="object"||$({data:a})){const c=Array.isArray(a)?a:[a];for(let u of c)i.append(o,u)}else{let c={};c[o]=a,i.append("@jsonPayload",JSON.stringify(c))}}return i}(t.body),D(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||U(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const s=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(s);const n=new AbortController;this.cancelControllers[s]=n,t.signal=n.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let s in e)if(s.toLowerCase()==t)return e[s];return null}}const Oe="https://judo.1ms.it",k=new Q(Oe),He=async(r,e)=>{try{return{success:!0,admin:(await k.admins.authWithPassword(r,e)).admin}}catch(t){return{success:!1,error:t.message||"Errore durante il login"}}},Je=()=>{k.authStore.clear(),typeof window<"u"&&localStorage.removeItem("oauth_provider")},Ce=async r=>{const[e]=y();if(confirm("Sei sicuro di voler eliminare questo task?"))try{await k.collection("task_admin").delete(r),await e()}catch{alert("Errore nell'eliminazione del task")}},ke=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_eSgrt040BRA:Ce},Symbol.toStringTag,{value:"Module"})),Te=()=>{const[r,e]=y();return r(e)},xe=Object.freeze(Object.defineProperty({__proto__:null,s_EyrokO1qYCo:Te},Symbol.toStringTag,{value:"Module"})),Pe=X(m(()=>f(()=>import("./q-DtG6geqk.js").then(r=>r.r),[]),"s_Mn6LDBBEX0I")),Re=r=>{ee();const e=E([]),t=E(!0),s=E(!1),n=E(null),i=m(()=>f(()=>Promise.resolve().then(()=>Be),void 0),"s_U7Gtvxqg5eI",[t,e]);te(m(()=>f(()=>Promise.resolve().then(()=>qe),void 0),"s_0Eq5pHw5aHw",[i]));const o=m(()=>f(()=>Promise.resolve().then(()=>Ne),void 0),"s_iF5Su0pCqYY",[i]),a=m(()=>f(()=>Promise.resolve().then(()=>ke),void 0),"s_eSgrt040BRA",[i]),c=m(()=>f(()=>Promise.resolve().then(()=>Fe),void 0),"s_xyZW3vC107I",[s,n]),u=l=>{switch(l){case"urgente":return"bg-red-100 text-red-600 dark:bg-red-900/20 dark:text-red-400";case"alta":return"bg-orange-100 text-orange-600 dark:bg-orange-900/20 dark:text-orange-400";case"media":return"bg-blue-100 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400";case"bassa":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},w=l=>{switch(l){case"urgente":return"ðŸ”´";case"alta":return"ðŸŸ ";case"media":return"ðŸ”µ";case"bassa":return"âšª";default:return"âšª"}},p=l=>{switch(l){case"completato":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-400";case"in_corso":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"bloccato":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";case"aperto":return"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"}};return t.value?d("div",null,{class:"space-y-3"},[1,2,3].map(l=>d("div",null,{class:"h-16 bg-gray-50 dark:bg-gray-800 rounded-xl animate-pulse"},null,3,l)),1,"Ce_0"):e.value.length===0?d("div",null,{class:"text-center py-12"},[d("div",null,{class:"text-5xl mb-4"},"âœ“",3,null),d("p",null,{class:"text-gray-400 font-bold text-sm"},"Nessun task in sospeso",3,null)],3,"Ce_1"):d("div",null,{class:"space-y-3 max-h-[500px] overflow-y-auto custom-scrollbar"},[e.value.map(l=>{var v;return d("div",{class:`group flex items-start gap-4 p-4 rounded-xl border transition-all ${l.completato?"bg-gray-50/50 dark:bg-gray-800/30 border-gray-200 dark:border-gray-700 opacity-60":l.in_evidenza?"bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800 shadow-sm":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:shadow-md"}`},null,[l.in_evidenza&&!l.completato&&d("div",null,{class:"absolute top-2 right-2 text-xs"},"ðŸ“Œ",3,"Ce_2"),d("button",{class:`flex-shrink-0 w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${l.completato?"bg-emerald-500 border-emerald-500":"border-gray-300 dark:border-gray-600 hover:border-emerald-400"}`,onClick$:m(()=>f(()=>Promise.resolve().then(()=>Ae),void 0),"s_oh42BFfSP3I",[l,o])},null,l.completato&&d("span",null,{class:"text-white text-sm"},"âœ“",3,"Ce_3"),0,null),d("div",null,{class:"flex-1 min-w-0"},[d("div",null,{class:"flex items-start justify-between gap-3"},[d("div",null,{class:"flex-1"},[d("p",{class:`text-sm font-bold ${l.completato?"line-through text-gray-400":"text-gray-900 dark:text-gray-100"}`},null,l.titolo||"Senza Titolo",1,null),(l.contenuto||l.descrizione_breve)&&d("p",null,{class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},l.descrizione_breve||l.contenuto,1,"Ce_4"),((v=l.expand)==null?void 0:v.assegnato_a_id)&&d("p",null,{class:"text-[10px] text-gray-400 mt-1"},["ðŸ‘¤ ",l.expand.assegnato_a_id.name||l.expand.assegnato_a_id.email],1,"Ce_5")],1,null),d("div",null,{class:"flex flex-col items-end gap-1"},[d("span",{class:`px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-wider ${u(l.priorita||"media")}`},null,[w(l.priorita||"media")," ",l.priorita||"media"],1,null),l.stato&&l.stato!=="aperto"&&d("span",{class:`px-2 py-0.5 rounded text-[9px] font-bold ${p(l.stato)}`},null,ne(l,"stato"),1,"Ce_6")],1,null)],1,null),l.data_riferimento&&d("p",null,{class:"text-[10px] text-gray-400 mt-2"},["ðŸ“… ",new Date(l.data_riferimento).toLocaleDateString("it-IT")],1,"Ce_7"),l.promemoria_inviato&&d("p",null,{class:"text-[10px] text-emerald-600 dark:text-emerald-400 mt-1"},"âœ‰ï¸ Promemoria inviato",3,"Ce_8"),d("div",null,{class:"flex items-center gap-2 mt-3 opacity-0 group-hover:opacity-100 transition-opacity"},[d("button",{onClick$:m(()=>f(()=>Promise.resolve().then(()=>xe),void 0),"s_EyrokO1qYCo",[c,l])},{class:"px-3 py-1.5 bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400 rounded-lg text-xs font-bold hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",title:"Invia promemoria via email"},"ðŸ“§ Sollecita",2,null),d("button",{onClick$:m(()=>f(()=>Promise.resolve().then(()=>Ve),void 0),"s_NqOogLA7ge0",[a,l])},{class:"px-3 py-1.5 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-lg text-xs font-bold hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors"},"ðŸ—‘ï¸ Elimina",2,null)],1,null)],1,null)],1,l.id)}),se(Pe,{get isOpen(){return s.value},get task(){return n.value},onClose$:m(()=>f(()=>Promise.resolve().then(()=>Le),void 0),"s_qMthlahGvkA",[s]),onSent$:m(()=>f(()=>Promise.resolve().then(()=>ze),void 0),"s_PCzgjmycFe0",[i]),[ie]:{isOpen:M(l=>l.value,[s]),task:M(l=>l.value,[n])}},2,"Ce_9")],1,"Ce_10")},Ye=Object.freeze(Object.defineProperty({__proto__:null,s_4POcaaixRjI:Re},Symbol.toStringTag,{value:"Module"})),Ie=()=>{const[r]=y();return r.value=!1},Le=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_qMthlahGvkA:Ie},Symbol.toStringTag,{value:"Module"})),Ee=()=>{const[r,e]=y();return e(r.id,r.completato)},Ae=Object.freeze(Object.defineProperty({__proto__:null,s_oh42BFfSP3I:Ee},Symbol.toStringTag,{value:"Module"})),je=()=>{const[r]=y();r()},qe=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_0Eq5pHw5aHw:je},Symbol.toStringTag,{value:"Module"})),Ue=async(r,e)=>{const[t]=y();try{const s=!e;await k.collection("task_admin").update(r,{completato:s,stato:s?"completato":"aperto"}),await t()}catch{alert("Errore nell'aggiornamento del task")}},Ne=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_iF5Su0pCqYY:Ue},Symbol.toStringTag,{value:"Module"})),De=r=>{const[e,t]=y();t.value=r,e.value=!0},Fe=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_xyZW3vC107I:De},Symbol.toStringTag,{value:"Module"})),Me=async()=>{const[r,e]=y();r.value=!0;try{console.log("[AdminTaskList] Fetching tasks from task_admin..."),console.log("[AdminTaskList] Auth state:",{isValid:k.authStore.isValid,token:k.authStore.token?"EXISTS":"MISSING"});const t=await k.collection("task_admin").getFullList({requestKey:null,expand:"assegnato_a_id"});console.log("[AdminTaskList] âœ… Fetched tasks:",t.length),t.length>0&&console.log("[AdminTaskList] First task:",t[0]),e.value=t}catch(t){console.error("[AdminTaskList] âŒ Error fetching tasks:",{message:t.message,status:t.status,data:t.data}),e.value=[]}finally{r.value=!1}},Be=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_U7Gtvxqg5eI:Me},Symbol.toStringTag,{value:"Module"})),Ke=()=>{const[r]=y();return r()},ze=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_PCzgjmycFe0:Ke},Symbol.toStringTag,{value:"Module"})),$e=()=>{const[r,e]=y();return r(e.id)},Ve=Object.freeze(Object.defineProperty({__proto__:null,s_NqOogLA7ge0:$e},Symbol.toStringTag,{value:"Module"}));export{Q as C,T as _hW,He as a,Ye as b,Je as l,k as p,je as s_0Eq5pHw5aHw,Re as s_4POcaaixRjI,Te as s_EyrokO1qYCo,$e as s_NqOogLA7ge0,Ke as s_PCzgjmycFe0,Me as s_U7Gtvxqg5eI,Ce as s_eSgrt040BRA,Ue as s_iF5Su0pCqYY,Ee as s_oh42BFfSP3I,Ie as s_qMthlahGvkA,De as s_xyZW3vC107I};
