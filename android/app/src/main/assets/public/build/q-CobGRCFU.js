import{u as g,b as f,q as u,l as _,p as y,C as e,k as b,i as h,j as v,G as w,_hW as m}from"./q-GWx3MS6J.js";import{_ as d}from"./q-DoNi8vyY.js";import{p as x}from"./q-CpnnSTOF.js";const P=l=>{const[a]=g();return a.value=l.target.value},T=Object.freeze(Object.defineProperty({__proto__:null,s_iBGHLriwfTI:P},Symbol.toStringTag,{value:"Module"})),p=async()=>{const l=await x.collection("bacheca").getFullList({sort:"-data_riferimento",requestKey:null}),a=new Date,n=[],r=[];for(const t of l){const o={id:t.id,title:t.titolo,date:t.data_riferimento,activity:t.tags,cover_image:t.immagine_principale,data_fine:t.data_fine};o.data_fine&&new Date(o.data_fine)<a?r.push(o):n.push(o)}return{bacheca:n,archivio:r}},k=f(u(()=>d(()=>Promise.resolve().then(()=>A),void 0),"s_aF9mdhgJTN0")),O={title:"Gestione Bacheca â€“ Bacheca & Archivio",meta:[{name:"description",content:"Pannello di amministrazione con le sezioni Bacheca (attivi) e Archivio (scaduti)."}]},C=Object.freeze(Object.defineProperty({__proto__:null,_auto_loadPosts:p,default:k,head:O},Symbol.toStringTag,{value:"Module"})),S=async({track:l})=>{const[a,n,r,t]=g();l(()=>t.value),r.value=!0;try{const{bacheca:o,archivio:i}=await p(),c=s=>!t.value||s.title.toLowerCase().includes(t.value.toLowerCase())||s.activity&&s.activity.toLowerCase().includes(t.value.toLowerCase());n.value=o.filter(c),a.value=i.filter(c)}catch(o){console.error("Error loading posts:",o)}finally{r.value=!1}},j=Object.freeze(Object.defineProperty({__proto__:null,_hW:m,s_hx0OgrSpjHo:S},Symbol.toStringTag,{value:"Module"})),L=()=>{const[l,a]=g();return l(a.id,a.title)},E=Object.freeze(Object.defineProperty({__proto__:null,s_e6oaVXXueHs:L},Symbol.toStringTag,{value:"Module"})),D=async(l,a)=>{const[n,r]=g();if(confirm(`Sei sicuro di voler eliminare la news "${a}"?`))try{await x.collection("bacheca").delete(l);const{bacheca:t,archivio:o}=await p();r.value=t,n.value=o}catch(t){alert("Errore: "+t.message)}},H=Object.freeze(Object.defineProperty({__proto__:null,_hW:m,s_HKkvaheyOb4:D},Symbol.toStringTag,{value:"Module"})),I=()=>{const l=_(""),a=_([]),n=_([]),r=_(!0);y(u(()=>d(()=>Promise.resolve().then(()=>j),void 0),"s_hx0OgrSpjHo",[n,a,r,l]));const t=u(()=>d(()=>Promise.resolve().then(()=>H),void 0),"s_HKkvaheyOb4",[n,a]),o=({title:i,posts:c})=>e("section",null,{class:"space-y-6"},[e("h2",null,{class:"text-3xl font-black text-gray-900 dark:text-white"},i,1,null),r.value?e("div",null,{class:"flex justify-center py-12"},e("div",null,{class:"animate-spin h-8 w-8 border-4 border-red-600 border-t-transparent rounded-full"},null,3,null),3,"00_0"):c.length===0?e("div",null,{class:"text-center py-12 text-gray-500 dark:text-gray-400"},"Nessun post da mostrare.",3,"00_1"):e("div",null,{class:"grid gap-6 md:grid-cols-2"},c.map(s=>e("div",null,{class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-6 group hover:shadow-lg transition-shadow"},[e("h3",null,{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},w(s,"title"),1,null),e("div",null,{class:"mb-4"},e("span",null,{class:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs font-bold text-gray-500 uppercase tracking-widest border border-gray-200 dark:border-gray-600"},s.activity||"GENERALE",1,null),1,null),e("div",null,{class:"flex justify-between items-center text-sm text-gray-500 dark:text-gray-400"},[e("span",null,null,new Date(s.date).toLocaleDateString("it-IT"),1,null),e("div",null,{class:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity"},[e("a",{href:`/gestione/bacheca/${s.id}`},{class:"text-blue-600 hover:underline"},"Modifica",3,null),e("button",{onClick$:u(()=>d(()=>Promise.resolve().then(()=>E),void 0),"s_e6oaVXXueHs",[t,s])},{class:"text-red-600 hover:underline"},"Elimina",2,null)],1,null)],1,null)],1,s.id)),1,null)],1,"00_2");return e("div",null,{class:"max-w-5xl mx-auto p-6 space-y-12 animate-in fade-in duration-500"},[e("header",null,{class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8"},[e("div",null,null,[e("h1",null,{class:"text-3xl font-black text-gray-900 dark:text-white"},"Bacheca",3,null),e("p",null,{class:"text-gray-500 dark:text-gray-400"},"Gestisci le news, gli eventi e le comunicazioni del Dojo.",3,null)],3,null),e("a",null,{href:"/gestione/bacheca/new",class:"bg-orange-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:scale-105 transition-transform flex items-center gap-2"},[e("span",null,null,"âž•",3,null),e("span",null,null,"Nuova News",3,null)],3,null)],3,null),e("div",null,{class:"relative max-w-md mb-8"},[e("span",null,{class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"},"ðŸ”",3,null),e("input",null,{type:"text",placeholder:"Cerca titolo o attivitÃ ...",class:"w-full pl-12 pr-4 py-3 rounded-xl bg-gray-50 dark:bg-gray-800 border-none focus:ring-2 focus:ring-orange-500 outline-none text-gray-900 dark:text-white font-medium",value:h(i=>i.value,[l]),onInput$:u(()=>d(()=>Promise.resolve().then(()=>T),void 0),"s_iBGHLriwfTI",[l])},null,3,null)],3,null),b(o,{title:"ðŸ“š Bacheca",get posts(){return a.value},[v]:{title:v,posts:h(i=>i.value,[a])}},3,"00_3"),b(o,{title:"ðŸ“ Archivio",get posts(){return n.value},[v]:{title:v,posts:h(i=>i.value,[n])}},3,"00_4")],1,"00_5")},A=Object.freeze(Object.defineProperty({__proto__:null,s_aF9mdhgJTN0:I},Symbol.toStringTag,{value:"Module"}));export{m as _hW,C as i,D as s_HKkvaheyOb4,I as s_aF9mdhgJTN0,L as s_e6oaVXXueHs,S as s_hx0OgrSpjHo,P as s_iBGHLriwfTI};
