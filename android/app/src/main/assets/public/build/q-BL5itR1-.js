import{b as y,q as c,u as p,l as b,p as x,C as e,i as s,k as h,j as m,_hW as v}from"./q-GWx3MS6J.js";import{p as f}from"./q-CpnnSTOF.js";import{_ as d}from"./q-DoNi8vyY.js";import{u as k}from"./q-DZEaxapN.js";const w=l=>{var n;if(console.error("[PocketBase Error Parser]",l),(n=l.response)!=null&&n.data){const o=l.response.data,a=[];for(const[i,g]of Object.entries(o)){const u=g;a.push(`${i.toUpperCase()}: ${u.message}`)}if(a.length>0)return`Dati non validi:
â€¢ `+a.join(`
â€¢ `)}return l.message==="Failed to fetch"?"Errore di rete: Impossibile connettersi al server PocketBase.":l.message||"Errore sconosciuto durante il salvataggio."},P=y(c(()=>d(()=>import("./q-DP_3fIn4.js").then(l=>l.r),[]),"s_kw1ZyuXbcyw")),S=async l=>{const[n,o,a,i]=p();l.preventDefault(),o.value=!0,n.value=null;const g=l.target,u=new FormData(g),_=r=>(r||"untitled").toLowerCase().replace(/[Ã Ã¡Ã¢Ã£Ã¤Ã¥]/g,"a").replace(/[Ã¨Ã©ÃªÃ«]/g,"e").replace(/[Ã¬Ã­Ã®Ã¯]/g,"i").replace(/[Ã²Ã³Ã´ÃµÃ¶]/g,"o").replace(/[Ã¹ÃºÃ»Ã¼]/g,"u").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,100),t=u.get("titolo");u.get("slug")||u.append("slug",_(t));try{i.isNew?await f.collection("dizionario").create(u):await f.collection("dizionario").update(i.term.id,u),a("/gestione/dizionario")}catch(r){n.value=w(r),window.scrollTo({top:0,behavior:"smooth"})}finally{o.value=!1}},j=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_oLvQleq6AwU:S},Symbol.toStringTag,{value:"Module"})),E=()=>{const[l]=p();return l("/gestione/dizionario")},O=Object.freeze(Object.defineProperty({__proto__:null,s_PlUU0pDGBQ0:E},Symbol.toStringTag,{value:"Module"})),A=l=>{const[n]=p(),o=l.target;if(o.files&&o.files[0]){const a=URL.createObjectURL(o.files[0]);n.value=a}},T=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_1K80MJWNg0Y:A},Symbol.toStringTag,{value:"Module"})),M=l=>{var _;const n=k(),o=b(!1),a=b(null),i=b(null);x(c(()=>d(()=>Promise.resolve().then(()=>L),void 0),"s_EL7rnMcdsok",[i,l]));const g=c(()=>d(()=>Promise.resolve().then(()=>T),void 0),"s_1K80MJWNg0Y",[i]);return e("div",null,{class:"max-w-4xl mx-auto"},e("form",null,{class:"space-y-10 animate-in fade-in slide-in-from-bottom-4 duration-700",onSubmit$:c(()=>d(()=>Promise.resolve().then(()=>j),void 0),"s_oLvQleq6AwU",[a,o,n,l])},[a.value&&e("div",null,{class:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800 rounded-2xl text-red-600 dark:text-red-400 font-bold flex items-center gap-3"},[e("span",null,null,"âš ï¸",3,null),s(t=>t.value,[a])],3,"0z_0"),e("div",null,{class:"grid grid-cols-1 md:grid-cols-2 gap-8"},[e("div",null,{class:"space-y-6"},[e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Termine",3,null),e("input",null,{type:"text",name:"titolo",required:!0,value:s(t=>{var r;return(r=t.term)==null?void 0:r.titolo},[l]),placeholder:"es. Dojo",class:"w-full px-5 py-4 rounded-2xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all dark:text-white font-bold"},null,3,null)],3,null),e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Kanji",3,null),e("input",null,{type:"text",name:"titolo_secondario",value:s(t=>{var r;return(r=t.term)==null?void 0:r.titolo_secondario},[l]),placeholder:"es. é“å ´",class:"w-full px-5 py-4 rounded-2xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all dark:text-white font-serif text-xl"},null,3,null)],3,null),e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Pronuncia",3,null),e("input",null,{type:"text",name:"categoria_secondaria",value:s(t=>{var r;return(r=t.term)==null?void 0:r.categoria_secondaria},[l]),placeholder:"es. doo-joo",class:"w-full px-5 py-4 rounded-2xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all dark:text-white font-medium"},null,3,null)],3,null)],3,null),e("div",null,{class:"space-y-6"},e("div",null,{class:"space-y-2"},[e("div",null,{class:"relative group"},e("div",null,{class:"h-[100px] rounded-3xl bg-gray-50 dark:bg-gray-800/50 border-2 border-dashed border-gray-200 dark:border-gray-700 flex flex-col items-center justify-center relative shadow-inner transition-colors group-hover:bg-gray-100 dark:group-hover:bg-gray-800 focus-within:ring-2 focus-within:ring-emerald-500"},[e("div",null,{class:"text-center"},[e("span",null,{class:"text-2xl block mb-1"},"ðŸŽ™ï¸",3,null),e("span",null,{class:"text-[10px] font-black text-gray-400 uppercase tracking-widest"},s(t=>t.value?"Sostituisci Audio":"Carica MP3",[i]),3,null)],3,null),e("input",null,{type:"file",name:"audio",accept:"audio/mpeg, audio/mp3",class:"absolute inset-0 opacity-0 cursor-pointer z-10",onChange$:g},null,3,null)],3,null),3,null),i.value&&e("div",null,{class:"p-4 mt-4 rounded-3xl bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 shadow-sm animate-in fade-in slide-in-from-top-2 duration-500"},[e("div",null,{class:"flex items-center gap-3 mb-3"},[e("span",null,{class:"text-2xl"},"ðŸŽµ",3,null),e("div",null,{class:"flex-1 min-w-0"},[e("span",null,{class:"text-[9px] font-black text-emerald-600 uppercase tracking-widest block"},"Preview Pronuncia",3,null),e("p",null,{class:"text-[10px] text-gray-400 font-mono truncate"},((_=l.term)==null?void 0:_.audio)||(i.value.startsWith("blob:")?"Nuovo File":"File di Sistema"),1,null)],1,null)],1,null),e("div",null,{class:"flex items-center gap-2"},[e("audio",null,{src:s(t=>t.value,[i]),controls:!0,class:"h-10 flex-1 opacity-90"},null,3,i.value),e("button",null,{type:"button",class:"p-3 bg-emerald-600 text-white rounded-2xl shadow-lg shadow-emerald-500/20 hover:scale-105 active:scale-95 transition-all",onClick$:c(()=>d(()=>Promise.resolve().then(()=>C),void 0),"s_QcrNlhN3hpg",[i])},"â–¶ï¸",3,null)],3,null)],1,"0z_1")],1,null),1,null)],1,null),e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-xs font-black text-gray-400 uppercase tracking-widest px-1"},"Contenuto / Descrizione",3,null),h(P,{name:"contenuto",id:"contenuto",get value(){var t;return(t=l.term)==null?void 0:t.contenuto},placeholder:"Significato storico, tecnico o filosofico del termine...",[m]:{name:m,id:m,value:s(t=>{var r;return(r=t.term)==null?void 0:r.contenuto},[l]),placeholder:m}},3,"0z_2")],1,null),e("div",null,{class:"pt-10 border-t border-gray-100 dark:border-gray-800 flex justify-end gap-4"},[e("button",null,{type:"button",class:"px-8 py-4 rounded-2xl font-bold text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all",onClick$:c(()=>d(()=>Promise.resolve().then(()=>O),void 0),"s_PlUU0pDGBQ0",[n])},"Annulla",3,null),e("button",null,{type:"submit",disabled:s(t=>t.value,[o]),class:"px-10 py-4 rounded-2xl bg-emerald-700 text-white font-black text-lg shadow-xl shadow-emerald-500/20 hover:transform hover:-translate-y-1 transition-all disabled:opacity-50"},s((t,r)=>t.value?"Salvataggio...":r.isNew?"Crea Termine":"Salva Modifiche",[o,l]),3,null)],3,null)],1,null),1,"0z_3")},R=Object.freeze(Object.defineProperty({__proto__:null,s_nfGd7c0SHVM:M},Symbol.toStringTag,{value:"Module"})),z=({track:l})=>{var a;const[n,o]=p();l(()=>o.term),(a=o.term)!=null&&a.audio&&(n.value=o.term.audio.startsWith("media/")?"/"+o.term.audio:f.files.getUrl(o.term,o.term.audio))},L=Object.freeze(Object.defineProperty({__proto__:null,_hW:v,s_EL7rnMcdsok:z},Symbol.toStringTag,{value:"Module"})),D=()=>{const[l]=p();new Audio(l.value).play().catch(o=>alert("Errore: "+o.message))},C=Object.freeze(Object.defineProperty({__proto__:null,s_QcrNlhN3hpg:D},Symbol.toStringTag,{value:"Module"}));export{P as R,v as _hW,R as d,w as p,A as s_1K80MJWNg0Y,z as s_EL7rnMcdsok,E as s_PlUU0pDGBQ0,D as s_QcrNlhN3hpg,M as s_nfGd7c0SHVM,S as s_oLvQleq6AwU};
