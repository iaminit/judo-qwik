import{u as b,l as d,C as e,q as c,i as g,G as p,_hW as f}from"./q-GWx3MS6J.js";import{p as x}from"./q-CpnnSTOF.js";import{_}from"./q-DoNi8vyY.js";const y=async t=>{const[a,r,s,o,i,u]=b();if(t.preventDefault(),!u.value.trim()){r.value="Il titolo Ã¨ obbligatorio";return}s.value=!0,r.value="";const n={titolo:u.value.trim(),contenuto:a.value.trim(),priorita:o.value==="low"?"bassa":o.value==="medium"?"media":o.value==="high"?"alta":"urgente",completato:!1,stato:"aperto",pubblicato:!0};console.log("[TaskModal] Creating task in task_admin with data:",n);try{const l=await x.collection("task_admin").create(n);console.log("[TaskModal] âœ… Task created successfully in task_admin:",l);try{const v=await(await fetch("/api/email/task-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n.titolo,description:n.contenuto||"Nessuna descrizione",priority:n.priorita,createdBy:"Admin Dashboard"})})).json();v.success?console.log("[TaskModal] âœ‰ï¸ Email notification sent successfully"):console.warn("[TaskModal] âš ï¸ Email notification failed:",v.error)}catch(m){console.error("[TaskModal] âš ï¸ Error sending email notification:",m)}u.value="",a.value="",o.value="medium",i.onTaskCreated(),i.onClose()}catch(l){console.error("[TaskModal] âŒ Error creating task:",l),r.value=l.message||"Errore nella creazione del task"}finally{s.value=!1}},k=Object.freeze(Object.defineProperty({__proto__:null,_hW:f,s_MOGUBKZKqD8:y},Symbol.toStringTag,{value:"Module"})),h=t=>{const[a]=b();return a.value=t.target.value},w=Object.freeze(Object.defineProperty({__proto__:null,s_d3vicvOJfJI:h},Symbol.toStringTag,{value:"Module"})),T=t=>{const a=d(""),r=d(""),s=d("medium"),o=d(!1),i=d(""),u=c(()=>_(()=>Promise.resolve().then(()=>k),void 0),"s_MOGUBKZKqD8",[r,i,o,s,t,a]),n=[{value:"low",label:"Bassa",emoji:"âšª",color:"gray"},{value:"medium",label:"Media",emoji:"ðŸ”µ",color:"blue"},{value:"high",label:"Alta",emoji:"ðŸŸ ",color:"orange"},{value:"urgent",label:"Urgente",emoji:"ðŸ”´",color:"red"}];return t.isOpen?e("div",null,{class:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200"},[e("div",{onClick$:t.onClose},{class:"absolute inset-0 bg-black/60 backdrop-blur-sm"},null,2,null),e("div",null,{class:"relative bg-white dark:bg-gray-900 rounded-3xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden animate-in zoom-in-95 slide-in-from-bottom-4 duration-300"},[e("div",null,{class:"bg-gradient-to-r from-red-600 to-red-500 px-8 py-6"},e("div",null,{class:"flex items-center justify-between"},[e("div",null,{class:"flex items-center gap-3"},[e("div",null,{class:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center"},e("span",null,{class:"text-2xl"},"âœ“",3,null),3,null),e("div",null,null,[e("h2",null,{class:"text-2xl font-black text-white"},"Nuovo Task",3,null),e("p",null,{class:"text-sm text-white/80"},"Crea un nuovo task amministrativo",3,null)],3,null)],3,null),e("button",{onClick$:t.onClose},{class:"w-10 h-10 rounded-xl bg-white/10 hover:bg-white/20 flex items-center justify-center text-white transition-colors"},"âœ•",2,null)],1,null),1,null),e("form",null,{"preventdefault:submit":!0,class:"p-8 space-y-6",onSubmit$:u},[i.value&&e("div",null,{class:"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 p-4 rounded-lg animate-in slide-in-from-top-2"},e("p",null,{class:"text-sm font-bold text-red-600 dark:text-red-400"},["âŒ ",g(l=>l.value,[i])],3,null),3,"6v_0"),e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-sm font-black text-gray-700 dark:text-gray-300 uppercase tracking-wide"},"Titolo Task *",3,null),e("input",null,{type:"text",value:g(l=>l.value,[a]),placeholder:"es. Aggiornare foto tecniche",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none transition-all text-gray-900 dark:text-white font-medium",maxLength:200,onInput$:c(()=>_(()=>Promise.resolve().then(()=>S),void 0),"s_5OgG585sLLQ",[a])},null,3,null)],3,null),e("div",null,{class:"space-y-2"},[e("label",null,{class:"block text-sm font-black text-gray-700 dark:text-gray-300 uppercase tracking-wide"},"Descrizione (opzionale)",3,null),e("textarea",null,{value:g(l=>l.value,[r]),placeholder:"Aggiungi dettagli sul task...",rows:3,class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent outline-none transition-all text-gray-900 dark:text-white font-medium resize-none",maxLength:500,onInput$:c(()=>_(()=>Promise.resolve().then(()=>w),void 0),"s_d3vicvOJfJI",[r])},null,3,null)],3,null),e("div",null,{class:"space-y-3"},[e("label",null,{class:"block text-sm font-black text-gray-700 dark:text-gray-300 uppercase tracking-wide"},"PrioritÃ ",3,null),e("div",null,{class:"grid grid-cols-2 gap-3"},n.map(l=>e("button",{class:`px-4 py-3 rounded-xl border-2 transition-all font-bold text-sm flex items-center gap-2 ${s.value===l.value?`border-${l.color}-500 bg-${l.color}-50 dark:bg-${l.color}-900/20 text-${l.color}-600 dark:text-${l.color}-400 ring-2 ring-${l.color}-500/20`:"border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:border-gray-300"}`,onClick$:c(()=>_(()=>Promise.resolve().then(()=>j),void 0),"s_KQej77qYILQ",[l,s])},{type:"button"},[e("span",null,{class:"text-lg"},p(l,"emoji"),1,null),e("span",null,null,p(l,"label"),1,null)],0,l.value)),1,null)],1,null),e("div",null,{class:"flex gap-3 pt-4"},[e("button",{onClick$:t.onClose},{type:"button",class:"flex-1 px-6 py-3 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 font-bold rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"},"Annulla",2,null),e("button",null,{type:"submit",disabled:g(l=>l.value,[o]),class:"flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-500 text-white font-bold rounded-xl hover:from-red-700 hover:to-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl"},o.value?e("span",null,{class:"flex items-center justify-center gap-2"},[e("span",null,{class:"animate-spin"},"â³",3,null)," Creazione..."],3,"6v_1"):"âœ“ Crea Task",1,null)],1,null)],1,null)],1,null)],1,"6v_2"):null},P=Object.freeze(Object.defineProperty({__proto__:null,s_cXC4g5a6spI:T},Symbol.toStringTag,{value:"Module"})),O=()=>{const[t,a]=b();return a.value=t.value},j=Object.freeze(Object.defineProperty({__proto__:null,s_KQej77qYILQ:O},Symbol.toStringTag,{value:"Module"})),M=t=>{const[a]=b();return a.value=t.target.value},S=Object.freeze(Object.defineProperty({__proto__:null,s_5OgG585sLLQ:M},Symbol.toStringTag,{value:"Module"}));export{f as _hW,M as s_5OgG585sLLQ,O as s_KQej77qYILQ,y as s_MOGUBKZKqD8,T as s_cXC4g5a6spI,h as s_d3vicvOJfJI,P as t};
